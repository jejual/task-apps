- pipeline: "Note Apps Deployment Pipeline"
  on: "CLICK"
  refs:
  - "refs/heads/master"
  priority: "NORMAL"
  fail_on_prepare_env_warning: true
  actions:
  - action: "Execute: npm install & test"
    type: "BUILD"
    working_directory: "/buddy/task-apps"
    docker_image_name: "library/node"
    docker_image_tag: "14"
    execute_commands:
    - "# yarn install"
    - "npm install"
    - "npm test"
    volume_mappings:
    - "/:/buddy/task-apps"
    cache_base_image: true
    shell: "BASH"
  - action: "Deploy to Google Cloud Run [sinuous-tuner-303004]"
    type: "GOOGLE_CLOUD_RUN_DEPLOY"
    service: "demo-note-apps"
    application_name: "sinuous-tuner-303004"
    application_display_name: "sinuous-tuner-303004"
    region: "asia-southeast2"
    arguments: "--add-cloudsql-instances=sinuous-tuner-303004:asia-southeast2:jejual-digipreneur-service --set-env-vars=NODE_ENV=production,DB_NAME=note,DB_DIALECT=mysql"
    image: "gcr.io/sinuous-tuner-303004/demo-note-apps"
    platform: "MANAGED"
    shell: "SH"
    integration_hash: "NDm8VvJ4open7YYEa7Az1XPYRr"
